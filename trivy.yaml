# Trivy configuration file
# https://aquasecurity.github.io/trivy/latest/docs/references/configuration/config-file/
# Shared configuration for CI/CD and local use

# Timeout configuration
timeout: 10m

# Scan configuration
scan:
  # Scanner types (can be overridden per job)
  scanners:
    - vuln      # Vulnerability scanning
    - misconfig # IaC misconfiguration scanning
    - secret    # Secret scanning
    - license   # License checking

  # Directories to skip
  skip-dirs:
    - .git
    - vendor
    - node_modules
    - testdata

  # Files to skip
  skip-files:
    - "**/*_test.go"

# Severity threshold
severity:
  - CRITICAL
  - HIGH
  - MEDIUM

# Report only fixed vulnerabilities
vulnerability:
  ignore-unfixed: true
  type:
    - os
    - library

# Misconfiguration scan settings
misconfiguration:
  # IaC types to scan
  scanners:
    - dockerfile
    - kubernetes

# Output format (for local use, overridden in CI/CD)
format: table

# Ignore settings
ignore-file: .trivyignore

# License settings
license:
  # Allowed licenses
  ignored:
    - MIT
    - Apache-2.0
    - BSD-2-Clause
    - BSD-3-Clause
    - ISC

# Database settings
db:
  # Update DB before scanning
  skip-update: false
